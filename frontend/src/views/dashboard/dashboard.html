<div class="dashboard-page">
    <!-- Header del Dashboard -->
    <div class="dashboard-header mb-4">
        <div class="row align-items-center">
            <div class="col-md-6">
                <h1 class="dashboard-title">
                    <i class="bi bi-house-door"></i>
                    Dashboard
                </h1>
                <p class="dashboard-subtitle">Bienvenido al panel de control de TUPAD Organizador</p>
            </div>
            <div class="col-md-6 text-end">
                <button class="btn btn-outline-primary me-2" ng-click="dashboardCtrl.refreshDashboard()">
                    <i class="bi bi-arrow-clockwise"></i>
                    Actualizar
                </button>
                <button class="btn btn-outline-secondary" ng-click="dashboardCtrl.exportReport()">
                    <i class="bi bi-download"></i>
                    Exportar
                </button>
            </div>
        </div>
    </div>

    <!-- Loading -->
    <div ng-if="dashboardCtrl.loading" class="text-center py-5">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Cargando...</span>
        </div>
        <p class="mt-3 text-muted">Cargando estadísticas...</p>
    </div>

    <!-- Estadísticas Principales -->
    <div class="row mb-4" ng-if="!dashboardCtrl.loading">
        <div class="col-xl-3 col-md-6 mb-3">
            <div class="card stat-card stat-card-primary">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h6 class="card-title text-muted">Total Materias</h6>
                            <h2 class="stat-number">{{ dashboardCtrl.stats.totalMaterias }}</h2>
                        </div>
                        <div class="stat-icon">
                            <i class="bi bi-book"></i>
                        </div>
                    </div>
                    <div class="stat-footer">
                        <a href="#/materias" class="text-decoration-none">
                            Ver todas <i class="bi bi-arrow-right"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-3">
            <div class="card stat-card stat-card-success">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h6 class="card-title text-muted">Horarios</h6>
                            <h2 class="stat-number">{{ dashboardCtrl.stats.totalHorarios }}</h2>
                        </div>
                        <div class="stat-icon">
                            <i class="bi bi-calendar3"></i>
                        </div>
                    </div>
                    <div class="stat-footer">
                        <a href="#/horarios" class="text-decoration-none">
                            Ver horarios <i class="bi bi-arrow-right"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-3">
            <div class="card stat-card stat-card-info">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h6 class="card-title text-muted">Contenidos</h6>
                            <h2 class="stat-number">{{ dashboardCtrl.stats.totalContenidos }}</h2>
                        </div>
                        <div class="stat-icon">
                            <i class="bi bi-file-text"></i>
                        </div>
                    </div>
                    <div class="stat-footer">
                        <a href="#/contenidos" class="text-decoration-none">
                            Ver contenidos <i class="bi bi-arrow-right"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-3">
            <div class="card stat-card stat-card-warning">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h6 class="card-title text-muted">Evaluaciones</h6>
                            <h2 class="stat-number">{{ dashboardCtrl.stats.totalEvaluaciones }}</h2>
                            <small class="text-muted">{{ dashboardCtrl.stats.evaluacionesPendientes }}
                                pendientes</small>
                        </div>
                        <div class="stat-icon">
                            <i class="bi bi-clipboard-check"></i>
                        </div>
                    </div>
                    <div class="stat-footer">
                        <a href="#/evaluaciones" class="text-decoration-none">
                            Ver evaluaciones <i class="bi bi-arrow-right"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Gráficos y Contenido -->
    <div class="row" ng-if="!dashboardCtrl.loading">
        <!-- Gráficos -->
        <div class="col-lg-8 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="bi bi-graph-up"></i>
                        Estadísticas Generales
                    </h5>
                </div>
                <div class="card-body">
                    <ul class="nav nav-tabs" id="chartTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="materias-tab" data-bs-toggle="tab"
                                data-bs-target="#materias" type="button" role="tab">
                                Materias
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="evaluaciones-tab" data-bs-toggle="tab"
                                data-bs-target="#evaluaciones" type="button" role="tab">
                                Evaluaciones
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="horarios-tab" data-bs-toggle="tab" data-bs-target="#horarios"
                                type="button" role="tab">
                                Horarios Semanales
                            </button>
                        </li>
                    </ul>
                    <div class="tab-content mt-3" id="chartTabsContent">
                        <div class="tab-pane fade show active" id="materias" role="tabpanel">
                            <div class="chart-container" style="height: 300px;">
                                <canvas class="chart" chart-data="dashboardCtrl.chartData.materias"
                                    chart-options="dashboardCtrl.chartOptions" chart-type="'doughnut'"></canvas>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="evaluaciones" role="tabpanel">
                            <div class="chart-container" style="height: 300px;">
                                <canvas class="chart" chart-data="dashboardCtrl.chartData.evaluaciones"
                                    chart-options="dashboardCtrl.chartOptions" chart-type="'doughnut'"></canvas>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="horarios" role="tabpanel">
                            <div class="chart-container" style="height: 300px;">
                                <canvas class="chart" chart-data="dashboardCtrl.chartData.horarios"
                                    chart-options="dashboardCtrl.chartOptions" chart-type="'line'"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Actividad Reciente -->
        <div class="col-lg-4 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="bi bi-activity"></i>
                        Actividad Reciente
                    </h5>
                </div>
                <div class="card-body p-0">
                    <div class="activity-list">
                        <div ng-if="dashboardCtrl.recentActivity.length === 0" class="text-center py-4">
                            <i class="bi bi-inbox text-muted" style="font-size: 2rem;"></i>
                            <p class="text-muted mt-2">No hay actividad reciente</p>
                        </div>
                        <div ng-repeat="activity in dashboardCtrl.recentActivity" class="activity-item">
                            <div class="activity-icon">
                                <i class="bi" ng-class="dashboardCtrl.getActivityIcon(activity.tipo)"></i>
                            </div>
                            <div class="activity-content">
                                <div class="activity-title">{{ activity.titulo }}</div>
                                <div class="activity-time">{{ dashboardCtrl.formatRelativeDate(activity.fecha) }}</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Eventos Próximos -->
    <div class="row" ng-if="!dashboardCtrl.loading">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="bi bi-calendar-event"></i>
                        Eventos Próximos
                    </h5>
                </div>
                <div class="card-body">
                    <div ng-if="dashboardCtrl.upcomingEvents.length === 0" class="text-center py-4">
                        <i class="bi bi-calendar-x text-muted" style="font-size: 2rem;"></i>
                        <p class="text-muted mt-2">No hay eventos próximos</p>
                    </div>
                    <div class="row" ng-if="dashboardCtrl.upcomingEvents.length > 0">
                        <div ng-repeat="event in dashboardCtrl.upcomingEvents" class="col-md-6 col-lg-4 mb-3">
                            <div class="event-card">
                                <div class="event-header">
                                    <span class="badge" ng-class="'bg-' + dashboardCtrl.getStatusColor(event.estado)">
                                        {{ event.estado }}
                                    </span>
                                    <small class="text-muted">{{ dashboardCtrl.formatDate(event.fecha) }}</small>
                                </div>
                                <div class="event-title">{{ event.titulo }}</div>
                                <div class="event-description">{{ event.descripcion }}</div>
                                <div class="event-footer">
                                    <small class="text-muted">
                                        <i class="bi bi-tag"></i>
                                        {{ event.tipo }}
                                    </small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Acciones Rápidas -->
    <div class="row mt-4" ng-if="!dashboardCtrl.loading">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="bi bi-lightning"></i>
                        Acciones Rápidas
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3 col-sm-6 mb-3">
                            <button class="btn btn-outline-primary w-100"
                                ng-click="dashboardCtrl.navigateToModule('materias')">
                                <i class="bi bi-plus-circle"></i>
                                Nueva Materia
                            </button>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-3">
                            <button class="btn btn-outline-success w-100"
                                ng-click="dashboardCtrl.navigateToModule('horarios')">
                                <i class="bi bi-calendar-plus"></i>
                                Agregar Horario
                            </button>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-3">
                            <button class="btn btn-outline-info w-100"
                                ng-click="dashboardCtrl.navigateToModule('contenidos')">
                                <i class="bi bi-file-earmark-plus"></i>
                                Subir Contenido
                            </button>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-3">
                            <button class="btn btn-outline-warning w-100"
                                ng-click="dashboardCtrl.navigateToModule('evaluaciones')">
                                <i class="bi bi-clipboard-plus"></i>
                                Nueva Evaluación
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>